Starting CodeRabbit review in plain text mode...

Connecting to review service
Setting up
Analyzing
Reviewing

============================================================================
File: .claude/commands/typescript-migrate.md
Line: 1 to 95
Type: potential_issue

Prompt for AI Agent:
In .claude/commands/typescript-migrate.md around lines 95-96, there's a stray lone character on line 96 that broke the file end; remove that character (or restore the intended trailing newline) so the file ends cleanly, and while you're there open and verify each resource link (TypeScript Handbook, React TypeScript Cheatsheet, DefinitelyTyped) resolves correctly — fix any broken URLs or update them to the correct canonical links.



============================================================================
File: .claude/commands/test.md
Line: 30 to 46
Type: nitpick

Prompt for AI Agent:
In .claude/commands/test.md around lines 30 to 46, the document biases Jest by labeling it "Primary" which disregards existing project choices; update the text to be framework-agnostic by removing the "Primary" label, listing Jest, Vitest and Jasmine as equally supported options, and add a short note to detect the project's existing test framework (or prompt the team) before recommending a default.



============================================================================
File: .claude/commands/debug.md
Line: 3
Type: potential_issue

Prompt for AI Agent:
In .claude/commands/debug.md around line 3, the placeholder $ARGUMENTS is ambiguous; replace it with an explicit description of what the user must supply (e.g., "problem description", "relevant code snippet", "steps to reproduce", "expected vs actual behavior"), specify required format (single-line vs multi-line, file paths or inline code), and include one or two concrete examples showing valid inputs; also consider adding a short note about optional flags or sensitive data removal and localize the wording if the doc is in Portuguese.



============================================================================
File: .claude/commands/hooks.md
Line: 30 to 38
Type: nitpick

Prompt for AI Agent:
In .claude/commands/hooks.md around lines 30 to 38, the Requirements mention "Follow TypeScript conventions with proper generic types" but don't clarify applicability to JavaScript users; update the text to state that the conventions apply to both TypeScript and plain JavaScript authors, and add a short note: when authoring in JavaScript follow the same naming, cleanup, memoization and testing guidelines and omit TypeScript-specific generic/type syntax (or provide equivalent JSDoc hints), while keeping TypeScript-specific guidance as optional guidance for TS projects.



============================================================================
File: .claude/commands/debug.md
Line: 15 to 52
Type: nitpick

Prompt for AI Agent:
In .claude/commands/debug.md around lines 15 to 52, the review comment contains informal, slang and insulting language ("Documentação tá quente demais, sucka!", "fool", "Tenho pena do tolo") that is unprofessional; replace those phrases with a neutral, professional endorsement of the document (e.g., "Documentação clara e bem estruturada; approvo as alterações"), remove insults and slang entirely, keep the positive feedback about the six steps, debugging techniques, and common issues, and optionally add a brief, neutral note suggesting adding practical examples as a nice-to-have; ensure the approval token "[approve_code_changes]" remains if needed but formatted consistently with project conventions.



============================================================================
File: .claude/commands/npm-scripts.md
Line: 15 to 25
Type: nitpick

Prompt for AI Agent:
In .claude/commands/npm-scripts.md around lines 15 to 25, add a short note or extra step explaining how to handle situations where tests cannot be executed automatically (e.g., CI lacks required env vars, interactive prompts, external services, or network access): describe how to detect those cases, provide a clear fallback (manual verification steps or commands to run locally), document any environment variables or mock services required, and mention using skip/force flags or CI-specific alternatives so reviewers know what to do when automated testing is not possible.



============================================================================
File: .claude/commands/npm-scripts.md
Line: 1 to 3
Type: nitpick

Prompt for AI Agent:
In .claude/commands/npm-scripts.md around lines 1 to 3, the header and intro are clear but lack guidance on WHEN to use the NPM Scripts Assistant; update the file to add a short paragraph after the existing intro that explains intended use cases (e.g., creating, debugging, or optimizing npm scripts, common scenarios like CI/CD, local dev, or monorepos), include one or two brief examples of typical prompts a user would give, and any constraints (expected project structure or required tools) so readers know when to invoke this assistant.



============================================================================
File: .claude/commands/hooks.md
Line: 1 to 10
Type: nitpick

Prompt for AI Agent:
In .claude/commands/hooks.md around lines 1 to 10, the placeholders "" and "$ARGUMENTS" are vague; replace them with clearer wording like "descrição funcional do hook (ex.: fetchData, formValidation, localStorage)" and rename/describe the argument as "$HOOK_DESCRIPTION = Descrição funcional do hook (ex.: fetchData, formValidation, localStorage)" so users know exactly what to provide; update the usage example line to reflect the clearer placeholder (e.g., /hooks fetchData) and keep examples in parentheses for clarity.



============================================================================
File: CLAUDE.md
Line: 44 to 66
Type: nitpick

Prompt for AI Agent:
In CLAUDE.md around lines 44 to 66, the hardcoded exact line-counts for components (e.g., 145, 200+, 350+, 550+) are brittle and will become inaccurate; change those to an approximate notation (e.g., "~145 lines", "≈200 lines", or "200+ (approx.)") or remove precise counts entirely and add a short note that line counts are informational and may change, then update the three component entries to use the chosen approximate format and add one sentence stating counts are approximate and maintained informally.



============================================================================
File: CLAUDE.md
Line: 143 to 153
Type: nitpick

Prompt for AI Agent:
In CLAUDE.md around lines 143 to 153, the dependency list omits which package manager to use; add a single clear sentence at the top of this section stating the supported/default package manager (e.g., "This project uses npm" or "This project uses pnpm") and optionally a short note how to install dependencies (e.g., "run  install" and point readers to package.json), ensuring consistency with the repo's lockfile (package-lock.json, pnpm-lock.yaml, or yarn.lock).



============================================================================
File: CLAUDE.md
Line: 15 to 31
Type: nitpick

Prompt for AI Agent:
In CLAUDE.md around lines 15 to 31, the docs list formatting/typecheck hooks but do not state which git-hook manager is used; update the section to explicitly name the hooks tool (e.g., Husky, lefthook, or pre-commit), include installation steps (package to install or project script to run), and add the exact command(s) to enable/install the hooks locally (and any required post-install step), plus a short note on where the hook configuration lives in the repo.



============================================================================
File: CLAUDE.md
Line: 177 to 191
Type: nitpick

Prompt for AI Agent:
In CLAUDE.md around lines 177 to 191, the performance notes are fine but need to be more maintainable and actionable: replace the static "~50KB gzipped" claim with a note stating when that measurement was taken (or link to a script/command to re-measure) and add a short "Future optimization strategies" subsection listing concrete items to pursue (periodic bundle-size measurement script, code-splitting / dynamic imports, asset compression and modern image formats, use Web Workers or off-main-thread rendering for html2canvas, debounce/throttle export button, caching and HTTP headers, and lazy-loading non-critical modules). Ensure the new text is concise, dated (measurement date), and provides one-line actionable steps for each strategy so future contributors can follow them.



============================================================================
File: components/Checklist.tsx
Line: 25 to 29
Type: potential_issue

Prompt for AI Agent:
components/Checklist.tsx around lines 25 to 29: the inline comment above the useMemo is written in Spanish and breaks the repository's Portuguese-Brazil consistency; replace the Spanish comment with a Portuguese-Brazil equivalent (e.g., "Memoiza filteredSins para evitar recálculo a cada render") ensuring tone matches surrounding comments and keep it concise.



============================================================================
File: app/page.tsx
Line: 10 to 23
Type: nitpick

Prompt for AI Agent:
In app/page.tsx around lines 10–23: the dynamic import’s loading UI uses CSS variables (--celestial-gold, --celestial-text-soft) which must exist in your global CSS, the claimed “~400KB” savings should be validated with a bundle analysis, and the dynamic() call should explicitly disable SSR if Result relies on browser-only APIs; to fix, confirm and add those CSS variables to your global stylesheet (or replace with safe fallbacks), run a production build with @next/bundle-analyzer (or run npm run build and inspect output) to verify the reported bundle savings, and if Result uses window/localStorage/DOM-only APIs set ssr: false in the dynamic options.



============================================================================
File: .mcp.json
Line: 17 to 34
Type: potential_issue

Prompt for AI Agent:
In .mcp.json around lines 17-34, the Brave Search and Google Maps MCP entries reference BRAVE_API_KEY and GOOGLE_MAPS_API_KEY but no startup validation exists; add startup checks that verify required API keys are present before attempting to start each MCP (or mark the MCP optional and skip registration when the key is absent), and when missing produce a clear error message that names the missing variable and which MCP failed to register; alternatively update documentation/comments in the MCP config to state which services are optional vs. mandatory and how to provide the keys.



============================================================================
File: .mcp.json
Line: 1 to 43
Type: nitpick

Prompt for AI Agent:
In .mcp.json around lines 1-43 the MCP service entries lack operational configuration (no timeouts, retries/backoff, health checks, log levels or resource limits); update each service object to include standardized operational fields such as "timeoutMs" (per-request timeout), "retry" (policy with "retries" and "backoffMs" or "strategy"), "healthCheck" (path and intervalMs / timeoutMs), "logging" (level and format), and "resources" (cpuLimit, memoryLimit) while keeping existing keys (name, description, command, args, env) and preserving env templates like ${BRAVE_API_KEY}; ensure defaults are provided and validate schema so callers can override per-service values.



============================================================================
File: .mcp.json
Line: 6
Type: potential_issue

Prompt for AI Agent:
In .mcp.json around lines 6, 13, 20, 29 and 38 the configured commands ("server-memory", "code-reasoning", "server-brave-search", "server-google-maps", "mcp-code-graph") are referenced without absolute paths or existence checks; add a validation step (at app startup or CI pre-deploy) that verifies each command is resolvable in PATH (e.g., use shell "command -v" / "which" or a language-specific lookup like Node's "which" package or fs.access to the absolute path), fail fast with a clear error listing any missing executables, and/or allow configuring absolute paths or fallbacks in the config so the deploy will not proceed if required executables are unavailable.



============================================================================
File: app/globals.css
Line: 58
Type: nitpick

Prompt for AI Agent:
In app/globals.css around line 58, the font-family fallback list redundantly includes var(--font-cormorant) followed by the literal 'Cormorant Garamond'; keep the fallback during migration but once CSS variables are confirmed remove the duplicate literal to avoid redundancy. Update the line to either (a) retain only the CSS variable plus distinct fallbacks (remove 'Cormorant Garamond'), or (b) if you prefer the literal as primary, replace the variable with the literal and remove the var; ensure you keep at least one reliable fallback serif font.



============================================================================
File: lib/utils/imageExport.ts
Line: 47 to 51
Type: nitpick

Prompt for AI Agent:
In lib/utils/imageExport.ts around lines 47 to 51, the current wait (document.fonts.ready + fixed 100ms setTimeout) ensures render quality but may slow exports for users; change it to either reduce the fixed delay to 50ms and make the delay configurable via an exported option or environment flag, or replace the fixed timeout with a more efficient check such as awaiting the next animation frame(s) (requestAnimationFrame loop) after fonts.ready to allow quicker continuation when rendering is complete; also consider exposing a hook or callback so callers can show a loading indicator during the wait.



============================================================================
File: .mcp.json
Line: 22 to 24
Type: nitpick

Prompt for AI Agent:
In .mcp.json around lines 22-24 (and similarly lines 31-33), you correctly reference API keys via environment variables; update this by (1) adding a brief inline comment or new metadata fields next to each env entry that reference the rotation policy (rotation cadence, owner/contact, and where the keys are stored), and (2) document and enforce least-privilege by specifying the exact scopes/roles each key should have and by using service-specific keys (do not reuse a single key across services); also add a note in the project README linking to the secrets/rotation procedure and the responsible team so auditors and devs know how to rotate/revoke keys.



============================================================================
File: lib/utils/imageExport.ts
Line: 59 to 60
Type: potential_issue

Prompt for AI Agent:
In lib/utils/imageExport.ts around lines 59-60, the canvas export options currently set both useCORS: true and allowTaint: true which is unsafe; pick one strategy: if you control all image sources, set allowTaint: false and keep useCORS: true and ensure images send proper CORS headers; if you must render external images without CORS support, set useCORS: false and allowTaint: true and accept that toBlob/data extraction will be blocked or unsafe; update the options accordingly and add a short comment explaining which strategy was chosen.



============================================================================
File: .claude/settings.json
Line: 32
Type: potential_issue

Prompt for AI Agent:
In .claude/settings.json around line 32 the NODE_ENV key is hardcoded to "development", which risks incorrect environment behavior if this config is used in staging/production; remove the NODE_ENV entry so the runtime/environment supplies it, or replace it with an explicit placeholder indicating it must be provided externally (e.g., an empty value or env reference), and if you keep a default, add a clear comment above the line warning not to commit environment-specific defaults and to override via actual environment variables or deployment config.



============================================================================
File: lib/utils/imageExport.ts
Line: 1 to 7
Type: potential_issue

Prompt for AI Agent:
In lib/utils/imageExport.ts (exportToPNG function, add validation after line 45): the ExportOptions.scale is only documented as 1–4 but not validated at runtime; add a check that if scale is provided it is a finite integer between 1 and 4, otherwise throw a descriptive RangeError (or optionally clamp and log a warning) so invalid values like 0 or 100 are rejected before attempting rendering; ensure the check handles non-number values and preserves undefined (auto-detect) behavior.



============================================================================
File: .claude/settings.json
Line: 71 to 82
Type: potential_issue

Prompt for AI Agent:
In .claude/settings.json around lines 71–82, the hook uses GNU-specific xargs -r (breaks on macOS) and silences all eslint failures with || true; replace the xargs usage with a portable loop that feeds each file to npx eslint (e.g., read filenames line-by-line) and stop suppressing errors so eslint non-zero exits propagate; also ensure you skip running eslint when FILES is empty and preserve the existing git/package checks and timeout.



============================================================================
File: .claude/settings.json
Line: 37 to 47
Type: nitpick

Prompt for AI Agent:
In .claude/settings.json around lines 37 to 47 the shell hook appends the command and description to ~/.claude/bash-command-log.txt but omits a timestamp; modify the hook so each logged line is prefixed with an ISO-8601 timestamp (e.g. produced via date -u +"%Y-%m-%dT%H:%M:%SZ" or date +"%Y-%m-%dT%H:%M:%S%z") and a separator before the jq-generated command/description string; ensure the shell constructs the timestamp first, then pipes or embeds it into the jq output so every appended line begins with the timestamp followed by the existing command - description text, preserving the existing failure-safe "|| true" behavior.



============================================================================
File: .claude/settings.json
Line: 48 to 58
Type: potential_issue

Prompt for AI Agent:
In .claude/settings.json around lines 48 to 58, the PostToolUse hook only extracts a single file_path which breaks MultiEdit (which returns multiple files); update the command to parse either a single file_path or an array of file paths from STDIN_JSON, iterate over all entries, and run prettier --write for each matching .js/.jsx/.ts/.tsx file if npx is available. Ensure the iteration handles empty input safely, preserves the current timeout behavior, and swallows prettier errors (|| true) as before.



============================================================================
File: components/Result.tsx
Line: 224 to 241
Type: potential_issue

Prompt for AI Agent:
In components/Result.tsx around lines 224 to 241, the footer is wrapping the incoming accentColor (which already is in the form '[var(--name)]') with another var() call, producing invalid CSS like [var([var(--...)])]; remove the extra var() wrapper and interpolate the accentColor directly into the Tailwind bracketed utilities (use the existing bracketed value for bg classes and opacity variants, e.g. use bg-[]/40 and bg-[]/60 equivalents) so you no longer nest var() and the generated CSS stays valid.



============================================================================
File: components/Result.tsx
Line: 162 to 184
Type: nitpick

Prompt for AI Agent:
In components/Result.tsx around lines 162 to 184, the tweet share URL is hardcoded (line ~168); replace that literal with a dynamic origin so the share link works across deployments. Use either window.location.origin at runtime (const url = window.location.origin) or read a public env var (e.g. process.env.NEXT_PUBLIC_BASE_URL) and fall back to window.location.origin; ensure the value is URI-encoded when building the Twitter intent URL and keep existing noopener,noreferrer behavior.



============================================================================
File: .claude/settings.json
Line: 2 to 27
Type: nitpick

Prompt for AI Agent:
In .claude/settings.json around lines 2–27 the "deny" array blocks curl, wget and rm -rf but misses other high-risk shell commands; update the deny list to include dangerous utilities and patterns (e.g., dd, mkfs.*, fork-bomb pattern like :(){:|:&};:, shutdown, reboot, chmod -R /, and other low-level networking/tools you want blocked) using the same "Bash(...)" pattern/glob style so they cannot be executed; keep the existing defaultMode and overall structure unchanged.



Review completed ✔
